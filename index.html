async function fetchForecast() {
  try {
    const url = `https://api.openweathermap.org/data/2.5/forecast?lat=38.336418776106676&lon=-90.15364904539364&units=imperial&appid=${API_KEY}`;
    const res = await fetch(url);
    const data = await res.json();

    const container = document.getElementById("forecast");
    container.innerHTML = "";

    // Group by date
    const forecastByDay = {};
    data.list.forEach(item => {
      const date = new Date(item.dt * 1000).toLocaleDateString();
      if (!forecastByDay[date]) forecastByDay[date] = [];
      forecastByDay[date].push(item);
    });

    const days = Object.keys(forecastByDay).slice(0, 5);
    days.forEach(date => {
      forecastByDay[date].forEach((item, i) => {
        if (i % 3 === 0) { // Approx every 8 hours
          const time = new Date(item.dt * 1000);
          const hour = time.toLocaleTimeString([], { hour: 'numeric', hour12: true });
          const icon = `https://openweathermap.org/img/wn/${item.weather[0].icon}@2x.png`;
          const temp = Math.round(item.main.temp);
          const desc = item.weather[0].description;
          const windSpeed = item.wind.speed;
          const windGust = item.wind.gust ?? "N/A";

          const card = document.createElement("div");
          card.className = "forecast-day";
          card.innerHTML = `
            <div><strong>${date}</strong> - ${hour}</div>
            <img src="${icon}" alt="${desc}" title="${desc}" />
            <div>${desc}</div>
            <div>${temp} ¬∞F</div>
            <div>üå¨Ô∏è Wind: ${windSpeed.toFixed(1)} mph</div>
            <div>üí® Gusts: ${windGust !== "N/A" ? windGust.toFixed(1) : "N/A"} mph</div>
          `;
          container.appendChild(card);
        }
      });
    });
  } catch (err) {
    console.error("Forecast error:", err);
    document.getElementById("forecast").textContent = "Failed to load forecast.";
  }
}
